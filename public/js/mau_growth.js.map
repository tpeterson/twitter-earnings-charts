{"version":3,"sources":["mau_growth.js"],"names":["buildChart","full_stats","stat_type","change_type","bar_area","selectAll","stat_class","drawLine","attr","d","xScale","yScale","stat_name","y","on","append","data","indexOf","stats_shown","push","text","stat_label","quarter","d3","select","remove","scaleLinear","domain","length","range","mausUS_stat","plotStat","maus_stat","enter","document","getElementById","addEventListener","splice","earnings_stats","mausUS_qoq","maus_yoy","mausUS_yoy","maus_qoq","qoq_stats","yoy_stats","slice","focus"],"mappings":"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","file":"mau_growth.js","sourcesContent":["(function() {\n  const earnings_stats = [{\n      \"quarter\": \"Q2 2013\",\n      \"maus_qoq\": 6.86,\n      \"mausUS_qoq\": 2.08,\n      \"maus_yoy\": \"\",\n      \"mausUS_yoy\": \"\"\n    }, {\n      \"quarter\": \"Q3 2013\",\n      \"maus_qoq\": 6.42,\n      \"mausUS_qoq\": 8.16,\n      \"maus_yoy\": \"\",\n      \"mausUS_yoy\": \"\"\n    }, {\n      \"quarter\": \"Q4 2013\",\n      \"maus_qoq\": 3.88,\n      \"mausUS_qoq\": 1.89,\n      \"maus_yoy\": \"\",\n      \"mausUS_yoy\": \"\"\n    }, {\n      \"quarter\": \"Q1 2014\",\n      \"maus_qoq\": 5.81,\n      \"mausUS_qoq\": 5.56,\n      \"maus_yoy\": 25,\n      \"mausUS_yoy\": 18.75\n    }, {\n      \"quarter\": \"Q2 2014\",\n      \"maus_qoq\": 6.27,\n      \"mausUS_qoq\": 5.26,\n      \"maus_yoy\": 24.31,\n      \"mausUS_yoy\": 22.45\n    }, {\n      \"quarter\": \"Q3 2014\",\n      \"maus_qoq\": 4.8,\n      \"mausUS_qoq\": 5,\n      \"maus_yoy\": 22.41,\n      \"mausUS_yoy\": 18.87\n    }, {\n      \"quarter\": \"Q4 2014\",\n      \"maus_qoq\": 1.41,\n      \"mausUS_qoq\": 0,\n      \"maus_yoy\": 19.5,\n      \"mausUS_yoy\": 16.67\n    }, {\n      \"quarter\": \"Q1 2015\",\n      \"maus_qoq\": 4.86,\n      \"mausUS_qoq\": 3.17,\n      \"maus_yoy\": 18.43,\n      \"mausUS_yoy\": 14.04\n    }, {\n      \"quarter\": \"Q2 2015\",\n      \"maus_qoq\": 0.66,\n      \"mausUS_qoq\": 0,\n      \"maus_yoy\": 12.18,\n      \"mausUS_yoy\": 8.33\n    }, {\n      \"quarter\": \"Q3 2015\",\n      \"maus_qoq\": 0.99,\n      \"mausUS_qoq\": 1.54,\n      \"maus_yoy\": 8.1,\n      \"mausUS_yoy\": 4.76\n    }, {\n      \"quarter\": \"Q4 2015\",\n      \"maus_qoq\": -0.65,\n      \"mausUS_qoq\": -1.52,\n      \"maus_yoy\": 5.9,\n      \"mausUS_yoy\": 3.17\n    }, {\n      \"quarter\": \"Q1 2016\",\n      \"maus_qoq\": 1.64,\n      \"mausUS_qoq\": 0,\n      \"maus_yoy\": 2.65,\n      \"mausUS_yoy\": 0\n    }, {\n      \"quarter\": \"Q2 2016\",\n      \"maus_qoq\": 0.97,\n      \"mausUS_qoq\": 1.54,\n      \"maus_yoy\": 2.96,\n      \"mausUS_yoy\": 1.54\n    }, {\n      \"quarter\": \"Q3 2016\",\n      \"maus_qoq\": 1.28,\n      \"mausUS_qoq\": 1.52,\n      \"maus_yoy\": 3.26,\n      \"mausUS_yoy\": 1.52\n    }, {\n      \"quarter\": \"Q4 2016\",\n      \"maus_qoq\": 0.63,\n      \"mausUS_qoq\": 0.00,\n      \"maus_yoy\": 4.59,\n      \"mausUS_yoy\": 3.07\n    },\n    {\n      \"quarter\": \"Q1 2017\",\n      \"maus_qoq\": 0.00,\n      \"mausUS_qoq\": 0.00,\n      \"maus_yoy\": 0.00,\n      \"mausUS_yoy\": 0.00\n    }\n  ];\n  // SEPARATE QUARTERLY AND YEARLY STATS\n  const qoq_stats = earnings_stats;\n  const yoy_stats = earnings_stats.slice(3);\n  // DISPLAY YEAR-OVER-YEAR CHART ON LOAD\n  document.addEventListener('DOMContentLoaded', () => {\n    document.getElementById('yearly_btn').focus();\n    buildChart(yoy_stats, 'yoy', 'year-over-year');\n  });\n  // TOGGLE BETWEEN CHARTS\n  document.getElementById('quarterly_btn').addEventListener('click', () => {\n    buildChart(qoq_stats, 'qoq', 'quarter-over-quarter');\n  });\n  document.getElementById('yearly_btn').addEventListener('click', () => {\n    buildChart(yoy_stats, 'yoy', 'year-over-year');\n  });\n\n  function buildChart(full_stats, stat_type, change_type) {\n    // RESET CHART\n    d3.select('#bar_area').remove();\n    d3.select(\"#bar_info\").text('Click dots to see figures');\n    const bar_area = d3.select('#main_chart').append('g').attr('id', 'bar_area');\n\n    // SET X AXIS SCALE\n    const xScale = d3.scaleLinear().domain([0, full_stats.length - 1]).range([\n      25,\n      500\n    ]);\n\n    // SET Y AXIS SCALE\n    const yScale = d3.scaleLinear().domain([\n      0,\n      25\n    ]).range([\n      0,\n      225\n    ]);\n\n    const maus_stat = `maus_${stat_type}`;\n    const mausUS_stat = `mausUS_${stat_type}`;\n\n    plotStat(maus_stat, 'stat_one', 'Global monthly active users', change_type);\n    plotStat(mausUS_stat, 'stat_two', 'U.S. monthly active users', change_type);\n\n    function plotStat(stat_name, stat_class, stat_label, change_type) {\n      const drawLine = d3.line()\n        .x(function(d) {\n          return xScale(full_stats.indexOf(d));\n        })\n        .y(function(d) {\n          return 250 - yScale(d[stat_name]);\n        });\n\n      bar_area\n        .append('path')\n        .attr('d', drawLine(full_stats))\n        .attr('class', stat_class);\n\n      bar_area.selectAll(`circle${[stat_class]}`)\n        .data(full_stats)\n        .enter()\n        .append('circle')\n        .attr('class', stat_class)\n        .attr(\"cx\", function(d) {\n          return xScale(full_stats.indexOf(d));\n        })\n        .attr(\"cy\", function(d) {\n          return 250 - yScale(d[stat_name]);\n        })\n        .attr(\"r\", function(d) {\n          return 5;\n        })\n        .on('click', function(d) {\n          d3.select('#bar_info').text(`${stat_label} ${(d[stat_name] >= 0) ? `grew ${d[stat_name]}` : `shrank ${d[stat_name]}`}% ${change_type} in ${d.quarter}.`);\n        });\n    }\n\n    // SET X AXIS ENTRY LABELS\n    bar_area.selectAll('text.x_label').data(full_stats).enter().append('text').attr('class', 'axis_label').text(function(d) {\n      return d.quarter;\n    }).attr('y', 305).attr('x', function(d) {\n      return xScale(full_stats.indexOf(d));\n    }).attr('transform', function(d) {\n      return 'rotate(90 ' + xScale(full_stats.indexOf(d)) + ' 305)';\n    });\n\n    // SET Y AXIS LABEL\n    d3.select('text#y_axis_label').text('25%');\n\n    // STORE STATUS OF EACH LINE\n    const stats_shown = ['global', 'us'];\n\n    // SHOW/HIDE LINE WHEN CHECKBOX IS CHECKED/UNCHECKED\n    document.getElementById('global_box').addEventListener('change', () => {\n      if (stats_shown.indexOf('global') === -1) {\n        stats_shown.push('global');\n        plotStat(maus_stat, 'stat_one', 'Global monthly active users', change_type);\n      } else {\n        stats_shown.splice(stats_shown.indexOf('global'), 1);\n        d3.select('path.stat_one').remove();\n        d3.selectAll('circle.stat_one').remove();\n      }\n    });\n\n    document.getElementById('us_box').addEventListener('change', () => {\n      if (stats_shown.indexOf('us') === -1) {\n        stats_shown.push('us');\n        plotStat(mausUS_stat, 'stat_two', 'U.S. monthly active users', change_type);\n      } else {\n        stats_shown.splice(stats_shown.indexOf('us'), 1);\n        d3.select('path.stat_two').remove();\n        d3.selectAll('circle.stat_two').remove();\n      }\n    });\n  }\n})();\n"]}