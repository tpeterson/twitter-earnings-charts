{"version":3,"sources":["mau_growth.js"],"names":["buildChart","full_stats","stat_type","change_type","plotStat","indexOf","stat_label","attr","d3","line","x","d","xScale","on","yScale","text","bar_area","append","selectAll","stat_class","enter","select","stats_shown","stat_name","document","getElementById","push","maus_stat","quarter","scaleLinear","domain","length","range","mausUS_stat","data","addEventListener","remove","splice","earnings_stats","mausUS_qoq","maus_yoy","mausUS_yoy","maus_qoq","yoy_stats","slice","focus","qoq_stats"],"mappings":"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","file":"mau_growth.js","sourcesContent":["(function() {\n  const earnings_stats = [{\n      \"quarter\": \"Q2 2013\",\n      \"maus_qoq\": 6.86,\n      \"mausUS_qoq\": 2.08,\n      \"maus_yoy\": \"\",\n      \"mausUS_yoy\": \"\"\n    }, {\n      \"quarter\": \"Q3 2013\",\n      \"maus_qoq\": 6.42,\n      \"mausUS_qoq\": 8.16,\n      \"maus_yoy\": \"\",\n      \"mausUS_yoy\": \"\"\n    }, {\n      \"quarter\": \"Q4 2013\",\n      \"maus_qoq\": 3.88,\n      \"mausUS_qoq\": 1.89,\n      \"maus_yoy\": \"\",\n      \"mausUS_yoy\": \"\"\n    }, {\n      \"quarter\": \"Q1 2014\",\n      \"maus_qoq\": 5.81,\n      \"mausUS_qoq\": 5.56,\n      \"maus_yoy\": 25,\n      \"mausUS_yoy\": 18.75\n    }, {\n      \"quarter\": \"Q2 2014\",\n      \"maus_qoq\": 6.27,\n      \"mausUS_qoq\": 5.26,\n      \"maus_yoy\": 24.31,\n      \"mausUS_yoy\": 22.45\n    }, {\n      \"quarter\": \"Q3 2014\",\n      \"maus_qoq\": 4.8,\n      \"mausUS_qoq\": 5,\n      \"maus_yoy\": 22.41,\n      \"mausUS_yoy\": 18.87\n    }, {\n      \"quarter\": \"Q4 2014\",\n      \"maus_qoq\": 1.41,\n      \"mausUS_qoq\": 0,\n      \"maus_yoy\": 19.5,\n      \"mausUS_yoy\": 16.67\n    }, {\n      \"quarter\": \"Q1 2015\",\n      \"maus_qoq\": 4.86,\n      \"mausUS_qoq\": 3.17,\n      \"maus_yoy\": 18.43,\n      \"mausUS_yoy\": 14.04\n    }, {\n      \"quarter\": \"Q2 2015\",\n      \"maus_qoq\": 0.66,\n      \"mausUS_qoq\": 0,\n      \"maus_yoy\": 12.18,\n      \"mausUS_yoy\": 8.33\n    }, {\n      \"quarter\": \"Q3 2015\",\n      \"maus_qoq\": 0.99,\n      \"mausUS_qoq\": 1.54,\n      \"maus_yoy\": 8.1,\n      \"mausUS_yoy\": 4.76\n    }, {\n      \"quarter\": \"Q4 2015\",\n      \"maus_qoq\": -0.65,\n      \"mausUS_qoq\": -1.52,\n      \"maus_yoy\": 5.9,\n      \"mausUS_yoy\": 3.17\n    }, {\n      \"quarter\": \"Q1 2016\",\n      \"maus_qoq\": 1.64,\n      \"mausUS_qoq\": 0,\n      \"maus_yoy\": 2.65,\n      \"mausUS_yoy\": 0\n    }, {\n      \"quarter\": \"Q2 2016\",\n      \"maus_qoq\": 0.97,\n      \"mausUS_qoq\": 1.54,\n      \"maus_yoy\": 2.96,\n      \"mausUS_yoy\": 1.54\n    }, {\n      \"quarter\": \"Q3 2016\",\n      \"maus_qoq\": 1.28,\n      \"mausUS_qoq\": 1.52,\n      \"maus_yoy\": 3.26,\n      \"mausUS_yoy\": 1.52\n    }, {\n      \"quarter\": \"Q4 2016\",\n      \"maus_qoq\": 0.63,\n      \"mausUS_qoq\": 0.00,\n      \"maus_yoy\": 4.59,\n      \"mausUS_yoy\": 3.07\n    },\n    {\n      \"quarter\": \"Q1 2017\",\n      \"maus_qoq\": 2.82,\n      \"mausUS_qoq\": 4.48,\n      \"maus_yoy\": 5.81,\n      \"mausUS_yoy\": 7.69\n    },\n    {\n      \"quarter\": \"Q2 2017\",\n      \"maus_qoq\": 0.00,\n      \"mausUS_qoq\": -2.86,\n      \"maus_yoy\": 4.79,\n      \"mausUS_yoy\": 3.03\n    }\n  ];\n  // SEPARATE QUARTERLY AND YEARLY STATS\n  const qoq_stats = earnings_stats;\n  const yoy_stats = earnings_stats.slice(3);\n  // DISPLAY YEAR-OVER-YEAR CHART ON LOAD\n  document.addEventListener('DOMContentLoaded', () => {\n    document.getElementById('yearly_btn').focus();\n    buildChart(yoy_stats, 'yoy', 'year-over-year');\n  });\n  // TOGGLE BETWEEN CHARTS\n  document.getElementById('quarterly_btn').addEventListener('click', () => {\n    buildChart(qoq_stats, 'qoq', 'quarter-over-quarter');\n  });\n  document.getElementById('yearly_btn').addEventListener('click', () => {\n    buildChart(yoy_stats, 'yoy', 'year-over-year');\n  });\n\n  function buildChart(full_stats, stat_type, change_type) {\n    // RESET CHART\n    d3.select('#bar_area').remove();\n    d3.select(\"#bar_info\").text('Click dots to see figures');\n    const bar_area = d3.select('#main_chart').append('g').attr('id', 'bar_area');\n\n    // SET X AXIS SCALE\n    const xScale = d3.scaleLinear().domain([0, full_stats.length - 1]).range([\n      25,\n      500\n    ]);\n\n    // SET Y AXIS SCALE\n    const yScale = d3.scaleLinear().domain([\n      0,\n      25\n    ]).range([\n      0,\n      225\n    ]);\n\n    const maus_stat = `maus_${stat_type}`;\n    const mausUS_stat = `mausUS_${stat_type}`;\n\n    plotStat(maus_stat, 'stat_one', 'Global monthly active users', change_type);\n    plotStat(mausUS_stat, 'stat_two', 'U.S. monthly active users', change_type);\n\n    function plotStat(stat_name, stat_class, stat_label, change_type) {\n      const drawLine = d3.line()\n        .x(function(d) {\n          return xScale(full_stats.indexOf(d));\n        })\n        .y(function(d) {\n          return 250 - yScale(d[stat_name]);\n        });\n\n      bar_area\n        .append('path')\n        .attr('d', drawLine(full_stats))\n        .attr('class', stat_class);\n\n      bar_area.selectAll(`circle${[stat_class]}`)\n        .data(full_stats)\n        .enter()\n        .append('circle')\n        .attr('class', stat_class)\n        .attr(\"cx\", function(d) {\n          return xScale(full_stats.indexOf(d));\n        })\n        .attr(\"cy\", function(d) {\n          return 250 - yScale(d[stat_name]);\n        })\n        .attr(\"r\", function(d) {\n          return 5;\n        })\n        .on('click', function(d) {\n          d3.select('#bar_info').text(`${stat_label} ${(d[stat_name] >= 0) ? `grew ${d[stat_name]}` : `shrank ${d[stat_name]}`}% ${change_type} in ${d.quarter}.`);\n        });\n    }\n\n    // SET X AXIS ENTRY LABELS\n    bar_area.selectAll('text.x_label').data(full_stats).enter().append('text').attr('class', 'axis_label').text(function(d) {\n      return d.quarter;\n    }).attr('y', 305).attr('x', function(d) {\n      return xScale(full_stats.indexOf(d));\n    }).attr('transform', function(d) {\n      return 'rotate(90 ' + xScale(full_stats.indexOf(d)) + ' 305)';\n    });\n\n    // SET Y AXIS LABEL\n    d3.select('text#y_axis_label').text('25%');\n\n    // STORE STATUS OF EACH LINE\n    const stats_shown = ['global', 'us'];\n\n    // SHOW/HIDE LINE WHEN CHECKBOX IS CHECKED/UNCHECKED\n    document.getElementById('global_box').addEventListener('change', () => {\n      if (stats_shown.indexOf('global') === -1) {\n        stats_shown.push('global');\n        plotStat(maus_stat, 'stat_one', 'Global monthly active users', change_type);\n      } else {\n        stats_shown.splice(stats_shown.indexOf('global'), 1);\n        d3.select('path.stat_one').remove();\n        d3.selectAll('circle.stat_one').remove();\n      }\n    });\n\n    document.getElementById('us_box').addEventListener('change', () => {\n      if (stats_shown.indexOf('us') === -1) {\n        stats_shown.push('us');\n        plotStat(mausUS_stat, 'stat_two', 'U.S. monthly active users', change_type);\n      } else {\n        stats_shown.splice(stats_shown.indexOf('us'), 1);\n        d3.select('path.stat_two').remove();\n        d3.selectAll('circle.stat_two').remove();\n      }\n    });\n  }\n})();\n"]}