{"version":3,"sources":["mau_growth.js"],"names":["buildChart","full_stats","stat_type","change_type","bar_area","stat_name","attr","drawLine","d3","line","selectAll","xScale","indexOf","d","y","yScale","append","stat_class","data","select","stats_shown","on","document","getElementById","text","stat_label","addEventListener","quarter","remove","scaleLinear","domain","length","range","plotStat","mausUS_stat","maus_stat","splice","enter","push","earnings_stats","maus_qoq","mausUS_qoq","maus_yoy","mausUS_yoy","qoq_stats","yoy_stats","slice","focus"],"mappings":"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","file":"mau_growth.js","sourcesContent":["(function() {\n  const earnings_stats = [{\n    \"quarter\": \"Q2 2013\",\n    \"maus_qoq\": 6.86,\n    \"mausUS_qoq\": 2.08,\n    \"maus_yoy\": \"\",\n    \"mausUS_yoy\": \"\"\n  }, {\n    \"quarter\": \"Q3 2013\",\n    \"maus_qoq\": 6.42,\n    \"mausUS_qoq\": 8.16,\n    \"maus_yoy\": \"\",\n    \"mausUS_yoy\": \"\"\n  }, {\n    \"quarter\": \"Q4 2013\",\n    \"maus_qoq\": 3.88,\n    \"mausUS_qoq\": 1.89,\n    \"maus_yoy\": \"\",\n    \"mausUS_yoy\": \"\"\n  }, {\n    \"quarter\": \"Q1 2014\",\n    \"maus_qoq\": 5.81,\n    \"mausUS_qoq\": 5.56,\n    \"maus_yoy\": 25,\n    \"mausUS_yoy\": 18.75\n  }, {\n    \"quarter\": \"Q2 2014\",\n    \"maus_qoq\": 6.27,\n    \"mausUS_qoq\": 5.26,\n    \"maus_yoy\": 24.31,\n    \"mausUS_yoy\": 22.45\n  }, {\n    \"quarter\": \"Q3 2014\",\n    \"maus_qoq\": 4.8,\n    \"mausUS_qoq\": 5,\n    \"maus_yoy\": 22.41,\n    \"mausUS_yoy\": 18.87\n  }, {\n    \"quarter\": \"Q4 2014\",\n    \"maus_qoq\": 1.41,\n    \"mausUS_qoq\": 0,\n    \"maus_yoy\": 19.5,\n    \"mausUS_yoy\": 16.67\n  }, {\n    \"quarter\": \"Q1 2015\",\n    \"maus_qoq\": 4.86,\n    \"mausUS_qoq\": 3.17,\n    \"maus_yoy\": 18.43,\n    \"mausUS_yoy\": 14.04\n  }, {\n    \"quarter\": \"Q2 2015\",\n    \"maus_qoq\": 0.66,\n    \"mausUS_qoq\": 0,\n    \"maus_yoy\": 12.18,\n    \"mausUS_yoy\": 8.33\n  }, {\n    \"quarter\": \"Q3 2015\",\n    \"maus_qoq\": 0.99,\n    \"mausUS_qoq\": 1.54,\n    \"maus_yoy\": 8.1,\n    \"mausUS_yoy\": 4.76\n  }, {\n    \"quarter\": \"Q4 2015\",\n    \"maus_qoq\": -0.65,\n    \"mausUS_qoq\": -1.52,\n    \"maus_yoy\": 5.9,\n    \"mausUS_yoy\": 3.17\n  }, {\n    \"quarter\": \"Q1 2016\",\n    \"maus_qoq\": 1.64,\n    \"mausUS_qoq\": 0,\n    \"maus_yoy\": 2.65,\n    \"mausUS_yoy\": 0\n  }, {\n    \"quarter\": \"Q2 2016\",\n    \"maus_qoq\": 0.97,\n    \"mausUS_qoq\": 1.54,\n    \"maus_yoy\": 2.96,\n    \"mausUS_yoy\": 1.54\n  }, {\n    \"quarter\": \"Q3 2016\",\n    \"maus_qoq\": 1.28,\n    \"mausUS_qoq\": 1.52,\n    \"maus_yoy\": 3.26,\n    \"mausUS_yoy\": 1.52\n  }];\n  // SEPARATE QUARTERLY AND YEARLY STATS\n  const qoq_stats = earnings_stats;\n  const yoy_stats = earnings_stats.slice(3);\n  // DISPLAY YEAR-OVER-YEAR CHART ON LOAD\n  document.addEventListener('DOMContentLoaded', () => {\n    document.getElementById('yearly_btn').focus();\n    buildChart(yoy_stats, 'yoy', 'year-over-year');\n  });\n  // TOGGLE BETWEEN CHARTS\n  document.getElementById('quarterly_btn').addEventListener('click', () => {\n    buildChart(qoq_stats, 'qoq', 'quarter-over-quarter');\n  });\n  document.getElementById('yearly_btn').addEventListener('click', () => {\n    buildChart(yoy_stats, 'yoy', 'year-over-year');\n  });\n\n  function buildChart(full_stats, stat_type, change_type) {\n    // RESET CHART\n    d3.select('#bar_area').remove();\n    d3.select(\"#bar_info\").text('Click dots to see figures');\n    const bar_area = d3.select('#main_chart').append('g').attr('id', 'bar_area');\n\n    // SET X AXIS SCALE\n    const xScale = d3.scaleLinear().domain([0, full_stats.length - 1]).range([\n      25,\n      500\n    ]);\n\n    // SET Y AXIS SCALE\n    const yScale = d3.scaleLinear().domain([\n      0,\n      25\n    ]).range([\n      0,\n      225\n    ]);\n\n    const maus_stat = `maus_${stat_type}`;\n    const mausUS_stat = `mausUS_${stat_type}`;\n\n    plotStat(maus_stat, 'stat_one', 'Global monthly active users', change_type);\n    plotStat(mausUS_stat, 'stat_two', 'U.S. monthly active users', change_type);\n\n    function plotStat(stat_name, stat_class, stat_label, change_type) {\n      const drawLine = d3.line()\n        .x(function(d) {\n          return xScale(full_stats.indexOf(d));\n        })\n        .y(function(d) {\n          return 250 - yScale(d[stat_name]);\n        });\n\n      bar_area\n        .append('path')\n        .attr('d', drawLine(full_stats))\n        .attr('class', stat_class);\n\n      bar_area.selectAll(`circle${[stat_class]}`)\n        .data(full_stats)\n        .enter()\n        .append('circle')\n        .attr('class', stat_class)\n        .attr(\"cx\", function(d) {\n          return xScale(full_stats.indexOf(d));\n        })\n        .attr(\"cy\", function(d) {\n          return 250 - yScale(d[stat_name]);\n        })\n        .attr(\"r\", function(d) {\n          return 5;\n        })\n        .on('click', function(d) {\n          d3.select('#bar_info').text(`${stat_label} ${(d[stat_name] >= 0) ? `grew ${d[stat_name]}` : `shrank ${d[stat_name]}`}% ${change_type} in ${d.quarter}.`);\n        });\n    }\n\n    // SET X AXIS ENTRY LABELS\n    bar_area.selectAll('text.x_label').data(full_stats).enter().append('text').attr('class', 'axis_label').text(function(d) {\n      return d.quarter;\n    }).attr('y', 305).attr('x', function(d) {\n      return xScale(full_stats.indexOf(d));\n    }).attr('transform', function(d) {\n      return 'rotate(90 ' + xScale(full_stats.indexOf(d)) + ' 305)';\n    });\n\n    // SET Y AXIS LABEL\n    d3.select('text#y_axis_label').text('25%');\n\n    // STORE STATUS OF EACH LINE\n    const stats_shown = ['global', 'us'];\n\n    // SHOW/HIDE LINE WHEN CHECKBOX IS CHECKED/UNCHECKED\n    document.getElementById('global_box').addEventListener('change', () => {\n      if (stats_shown.indexOf('global') === -1) {\n        stats_shown.push('global');\n        plotStat(maus_stat, 'stat_one', 'Global monthly active users', change_type);\n      } else {\n        stats_shown.splice(stats_shown.indexOf('global'), 1);\n        d3.select('path.stat_one').remove();\n        d3.selectAll('circle.stat_one').remove();\n      }\n    });\n\n    document.getElementById('us_box').addEventListener('change', () => {\n      if (stats_shown.indexOf('us') === -1) {\n        stats_shown.push('us');\n        plotStat(mausUS_stat, 'stat_two', 'U.S. monthly active users', change_type);\n      } else {\n        stats_shown.splice(stats_shown.indexOf('us'), 1);\n        d3.select('path.stat_two').remove();\n        d3.selectAll('circle.stat_two').remove();\n      }\n    });\n  }\n})();\n"]}